<div class="marco" fxShow="true" fxHide.lt-md="true">
    <div class="row">
        <div class="col">
            <h1>{{ titulo }}</h1>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <h3>Productos registrados</h3>
        </div>
        <div class="col" align="right">
            <button *ngIf="titulo == 'Compras'" mat-fab matTooltip="Agregar una compra" style="margin-bottom: 2%;"
                routerLink="/punto_compra"><mat-icon>add</mat-icon></button>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <mat-form-field appearance="fill">
                <mat-label>Selecciona un rango</mat-label>
                <mat-date-range-input [formGroup]="range" [rangePicker]="picker">
                    <input matStartDate formControlName="start" placeholder="Fecha Inicio">
                    <input matEndDate formControlName="end" placeholder="Fecha Fin">
                </mat-date-range-input>
                <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-date-range-picker #picker></mat-date-range-picker>

                <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Invalid start date</mat-error>
                <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
            </mat-form-field>
        </div>
    </div>
    <div class="table-container" style="display: block; overflow-x: auto;">
        <div class="loading-shade" *ngIf="isLoadingResults">
            <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
        </div>
        <table mat-table [dataSource]="dataSource1">

            <ng-container matColumnDef="fecha">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
                <td mat-cell *matCellDef="let row">{{ row.fecha | date:'fullDate' }}</td>
            </ng-container>

            <ng-container matColumnDef="nombre">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
                <td mat-cell *matCellDef="let row">{{ row.nombre.charAt(0).toUpperCase() + row.nombre.slice(1) }}</td>
            </ng-container>

            <ng-container matColumnDef="precio_unitario">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio Unitario</th>
                <td mat-cell *matCellDef="let row">{{ (row?.precio_venta ? row.precio_venta : row.precio_compra) |
                    currency }}</td>
            </ng-container>

            <ng-container matColumnDef="cantidad">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Cantidad</th>
                <td mat-cell *matCellDef="let row">{{ row.cantidad }}</td>
            </ng-container>

            <ng-container matColumnDef="precio_total">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio Total</th>
                <td mat-cell *matCellDef="let row">{{ row.precio | currency }}</td>
            </ng-container>

            <ng-container matColumnDef="ver_ticket">
                <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                <td mat-cell *matCellDef="let row"><button mat-mini-fab color="primary" matTooltip="Ver en ticket"
                        (click)="verTicket(row)"><mat-icon>receipt</mat-icon></button></td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator #paginator1 [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons pageSize="10">
        </mat-paginator>
    </div>
</div>
<div class="marco-mobiles" fxShow="true" fxHide.gt-sm="true">
    <div class="row">
        <div class="col">
            <h1>{{ titulo }}</h1>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <h3>Productos registrados</h3>
        </div>
        <div class="col" align="right">
            <button *ngIf="titulo == 'Compras'" mat-fab matTooltip="Agregar una compra" style="margin-bottom: 2%;"
                routerLink="/punto_compra"><mat-icon>add</mat-icon></button>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <mat-form-field appearance="fill">
                <mat-label>Selecciona un rango</mat-label>
                <mat-date-range-input [formGroup]="range" [rangePicker]="picker2">
                    <input matStartDate formControlName="start" placeholder="Fecha Inicio">
                    <input matEndDate formControlName="end" placeholder="Fecha Fin">
                </mat-date-range-input>
                <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint>
                <mat-datepicker-toggle matIconSuffix [for]="picker2"></mat-datepicker-toggle>
                <mat-date-range-picker #picker2></mat-date-range-picker>

                <mat-error *ngIf="range.controls.start.hasError('matStartDateInvalid')">Invalid start date</mat-error>
                <mat-error *ngIf="range.controls.end.hasError('matEndDateInvalid')">Invalid end date</mat-error>
            </mat-form-field>
        </div>
    </div>
    <div class="table-container" style="display: block; overflow-x: auto;">
        <div class="loading-shade" *ngIf="isLoadingResults">
            <mat-spinner *ngIf="isLoadingResults"></mat-spinner>
        </div>
        <table mat-table [dataSource]="dataSource2">

            <ng-container matColumnDef="fecha">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Fecha</th>
                <td mat-cell *matCellDef="let row">{{ row.fecha | date:'fullDate' }}</td>
            </ng-container>

            <ng-container matColumnDef="nombre">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</th>
                <td mat-cell *matCellDef="let row">{{ row.nombre.charAt(0).toUpperCase() + row.nombre.slice(1) }}</td>
            </ng-container>

            <ng-container matColumnDef="precio_unitario">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio Unitario</th>
                <td mat-cell *matCellDef="let row">{{ (row?.precio_venta ? row.precio_venta : row.precio_compra) |
                    currency }}</td>
            </ng-container>

            <ng-container matColumnDef="cantidad">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Cantidad</th>
                <td mat-cell *matCellDef="let row">{{ row.cantidad }}</td>
            </ng-container>

            <ng-container matColumnDef="precio_total">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Precio Total</th>
                <td mat-cell *matCellDef="let row">{{ row.precio | currency }}</td>
            </ng-container>

            <ng-container matColumnDef="ver_ticket">
                <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
                <td mat-cell *matCellDef="let row"><button mat-mini-fab color="primary" matTooltip="Ver en ticket"
                        (click)="verTicket(row)"><mat-icon>receipt</mat-icon></button></td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
        <mat-paginator #paginator2 showFirstLastButtons [pageSize]="5">
        </mat-paginator>
    </div>
</div>